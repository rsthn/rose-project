(sentinel::privilege-required admin)

(shield::validate

	(shield::field id
		required: true
		pattern: integer
	)
)

(shield::validate form

	(shield::field username
		required: false
		pattern: identifier
		min-length: 4
		max-length: 128
		check:username: (isnull (db::scalar `SELECT user_id FROM ##users WHERE user_id!={id} AND username={escape {formData.username}}`))
	)

	(shield::field password
		required: false
		min-length: 8
		set: (sentinel::password (formData.password))
	)

	(shield::field name
		required: false
		pattern: name
		min-length: 4
	)

	(shield::field is_authorized
		required: false
		pattern: bit
	)
)

(db::update ##users `user_id={id}` (form))

(call 'user_privileges.set')

(&)
